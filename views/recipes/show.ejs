<%- include('../partials/header') %>

<!-- displaying the recipe -->
    <div class="row">
        <div class="col-12 col-md 4">
            <h1>image</h1>
        </div>

        <div class="col-12 col-md-8">
            <div class="row">
                <div class="col-12"><h1><%= recipe.title %></h1></div>
                <div class="col-6 col-md-4 mb-4"><i class="bi bi-clock"></i> <%= recipe.cookTime %></div>
                <div class="col-6 col-md-4 mb-4"><i class="bi bi-clock"></i> <%= recipe.prepTime %></div>
                <div class="col-6 col-md-4 mb-4"><i class="bi-people-fill"></i> <%= recipe.serving %></div>
                <div class="col-12" style="white-space: pre-line;">
                    <h4>Ingredients</h4>
                    <%= recipe.ingredient %>
                </div>
                <div class="col-12" style="white-space: pre-line;">
                    <h4>Directions</h4>
                    <%= recipe.direction %> 
                </div>
            </div>
        </div>
    </div>
<br>
<br>

<!-- comments section -->

<div class="container pt-5">
    <div class="container">
        <form id="add-comment-form" method="POST" action="/recipes/<%= recipe._id %>/comments">
        <label for='comments' id='comments'>COMMENT</label>
        <div class="form-group pt-2">
        <textarea  class="form-control" placeholder="Leave a comment here" rows="4" name="content"></textarea>
        </div>
        <br>
        <button class="btn rounded-2 btn-primary" type="submit">POST COMMENT</button>  
        </form>
    </div>
</div>

<% if (recipe.comments.length) { %>
    <table>
        <thead>
            <tr>
                <th>Date</th>
                <th>Comment</th>
            </tr>
        </thead>
      <tbody>
        <% recipe.comments.forEach(function(r) { %>
            <tr>
                <td><%= r.createdAt.toLocaleDateString() %></td>
                <td><%= r.name %></td>
                <td><%= r.content %></td>
                <td>
                    <% if (user && user._id.equals(r.user)) { %>
                        <form action="/recipes/<%= r._id %>?_method=DELETE" method="POST">
                        <button type="submit">X</button>
                        </form>
                    <% } %>
                </td>
            </tr>
           <% }); %>
      </tbody>
    </table>
    <% } else { %>
      <h5>No Comments Yet</h5>
      <% } %>
<%- include('../partials/footer') %>